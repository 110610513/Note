# PersistentVolume

## 安裝 nfs server

- master

    - `yum install nfs-utils -y`

    - `mkdir -p /var/nfsshare`

    - `chmod -R 777 /var/nfsshare`

    - `vim /etc/exports`

        ```
        .
        .
        .
        /var/nfsshare  192.168.56.0/24(rw,sync,no_root_squash,no_all_squash)
        ```

    - `systemctl restart rpcbind`

    - `systemctl restart nfs-server`

- node01、node02

    - `yum install nfs-utils -y`

    - `mkdir -p /mnt/nfs/var/nfsshare`

    - `mount -t nfs 192.168.56.110:/var/nfsshare /mnt/nfs/var/nfsshare/` **:** 先測試可不可以掛載

    - `umount /mnt/nfs/var/nfsshare/`

## 使用集群

- windows

    - 使用 winscp 將檔案上傳至 master

        - [檔案](file/20201222/)

- master

    - `cd ~`

    - `vim pv.yaml`

        ```
        .
        .
        .
        nfs:
            path: /var/nfsshare
            server: 192.168.56.110
        ```

    - `kubectl apply -f pv.yaml`

    - `kubectl get pv`

    - `cd /var/nfsshare/`

    - `echo "hi" > hi.htm`

    - `echo "hello" > hello.htm`

    - `kubectl apply -f pvc.yaml`

    - `kubectl apply -f testpod.yaml`

    - `kubectl get pod -o wide`